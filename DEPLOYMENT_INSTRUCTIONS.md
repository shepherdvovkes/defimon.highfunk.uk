# Ethereum Node Deployment Instructions üöÄ

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **OS:** Linux (Ubuntu 20.04+ / Debian 11+)
- **RAM:** –ú–∏–Ω–∏–º—É–º 16GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 32GB)
- **CPU:** 4+ —è–¥—Ä–∞
- **–î–∏—Å–∫:** –ú–∏–Ω–∏–º—É–º 2TB SSD (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 4TB+)
- **–°–µ—Ç—å:** –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ:
- **Docker:** 20.10+
- **Docker Compose:** 1.29+
- **Git:** –ü–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/shepherdvovkes/defimon.highfunk.uk.git
cd defimon.highfunk.uk
git checkout eth_full_node_lenovo
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp env.infura.example .env.infura

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env.infura
nano .env.infura
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ .env.infura:**
```
REQUEST_URL=https://mainnet.infura.io/v3/YOUR_INFURA_API_KEY
INFURA_API_KEY=YOUR_INFURA_API_KEY
CHECKPOINT_SYNC_URL=https://beaconstate-mainnet.chainsafe.io
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ JWT —Å–µ–∫—Ä–µ—Ç–æ–≤
```bash
cd infrastructure/geth-monitoring
cp ../../.env.infura .env
```

---

## üê≥ –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### 1. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
cd infrastructure/geth-monitoring
docker-compose --profile internal-geth up -d
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
docker-compose ps
```

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
# Geth
docker-compose logs -f geth

# Lighthouse
docker-compose logs -f lighthouse

# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:

| –°–µ—Ä–≤–∏—Å | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|----------|
| Grafana | http://YOUR_IP:3000 | –î–∞—à–±–æ—Ä–¥—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ |
| Prometheus | http://YOUR_IP:9091 | –ú–µ—Ç—Ä–∏–∫–∏ |
| Geth HTTP | http://YOUR_IP:8545 | Ethereum JSON-RPC |
| Geth WS | ws://YOUR_IP:8546 | WebSocket API |
| Lighthouse | http://YOUR_IP:5052 | Beacon API |
| Node Exporter | http://YOUR_IP:9100 | –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ |

### –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Grafana:
- **–õ–æ–≥–∏–Ω:** admin
- **–ü–∞—Ä–æ–ª—å:** Cal1f0rn1a@2025

---

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: Checkpoint Sync (Lighthouse)
- –í—Ä–µ–º—è: 5-10 –º–∏–Ω—É—Ç
- –°—Ç–∞—Ç—É—Å: –ó–∞–≥—Ä—É–∑–∫–∞ checkpoint —Å chainsafe.io
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä: "Loaded checkpoint block and state"

### –≠—Ç–∞–ø 2: Execution Sync (Geth)
- –í—Ä–µ–º—è: 10-20 –º–∏–Ω—É—Ç
- –°—Ç–∞—Ç—É—Å: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –±–ª–æ–∫–æ–≤
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä: "Syncing beacon headers"

### –≠—Ç–∞–ø 3: –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- –í—Ä–µ–º—è: 15-30 –º–∏–Ω—É—Ç
- –°—Ç–∞—Ç—É—Å: –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä: "Syncing" -> "Synced"

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ Geth:
```bash
curl -X POST -H 'Content-Type: application/json' \
  --data '{"jsonrpc":"2.0","method":"eth_syncing","params":[],"id":1}' \
  http://localhost:8545
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Lighthouse:
```bash
curl http://localhost:5052/eth/v1/node/syncing
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ Prometheus:
```bash
curl http://localhost:9091/api/v1/targets
```

---

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: JWT —Å–µ–∫—Ä–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
docker volume rm geth-monitoring_lighthouse_data
docker volume rm geth-monitoring_geth_data

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
docker-compose --profile internal-geth up -d
```

### –ü—Ä–æ–±–ª–µ–º–∞: Lighthouse –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Geth
**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Geth —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—Ç—É
docker exec geth-full-node netstat -tlnp | grep 8551

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Geth
docker-compose restart geth
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã Docker
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- –£–±–µ–¥–∏—Ç—å—Å—è –≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ RAM

---

## üìà –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Docker:
```bash
# –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç—ã –ø–∞–º—è—Ç–∏
docker update --memory=32g --memory-swap=64g geth-full-node
docker update --memory=16g --memory-swap=32g lighthouse-beacon
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Geth:
- `--cache=8192` (—É–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ RAM)
- `--maxpeers=50` (–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥ —Å–µ—Ç—å)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Lighthouse:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. **–§–∞–π—Ä–≤–æ–ª:** –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º
2. **VPN:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å VPN –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –≤ Grafana

### –ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ:
- **8545:** HTTP API (–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø)
- **8546:** WebSocket API (–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø)
- **8551:** Engine API (—Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ)
- **3000:** Grafana (–∑–∞—â–∏—Ç–∏—Ç—å –ø–∞—Ä–æ–ª–µ–º)
- **9091:** Prometheus (–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø)

---

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ
docker-compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–µ—Ä–≤–∏—Å
docker-compose restart geth

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f lighthouse

# –û–±–Ω–æ–≤–∏—Ç—å –æ–±—Ä–∞–∑—ã
docker-compose pull
docker-compose up -d
```

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø –¥–∞–Ω–Ω—ã—Ö
docker run --rm -v geth-monitoring_geth_data:/data -v $(pwd):/backup alpine tar czf /backup/geth-backup.tar.gz -C /data .

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
docker run --rm -v geth-monitoring_geth_data:/data -v $(pwd):/backup alpine tar xzf /backup/geth-backup.tar.gz -C /data
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –≤ Grafana**
3. **–°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥—ã –¥–ª—è Ethereum –º–µ—Ç—Ä–∏–∫**
4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã**
5. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–∏**

---

*–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω—ã –¥–ª—è –≤–µ—Ä—Å–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ—Ç 9 –∞–≤–≥—É—Å—Ç–∞ 2025*
